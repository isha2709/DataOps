# Sample YAML file to validate and export an ARM template into a build artifact
# Requires a package.json file located in the target repository

trigger:
- master

pool:
  vmImage: 'windows-latest'

# variables:
#   - group: DataOpsUAT
  
steps:

- powershell: dir $(Build.SourcesDirectory) -recurse

- task: UsePythonVersion@0
  displayName: Configuring Python Version
  inputs:
    versionSpec: '3.x'
    addToPath: true
    architecture: 'x64'

- script: |
    pip3 install --upgrade databricks-cli
    echo "$(databricks.host)
    $(databricks.token)" | databricks configure --token
    

# - powershell: |
#     pip3 install --upgrade databricks-cli
    
#     $args = @"
#     $(databricks.host)

#     $(databricks.token)

#     "@

#     Write-Output $args

#     Write-Output "https://adb-3222810994145560.0.azuredatabricks.net" | databricks configure --token 

#     Write-Output "`nDatabricks workspace list:"
#     & databricks workspace list
#   displayName: Configure databricks

# - bash: |
#     pip3 install --upgrade databricks-cli

#     databricks configure --token <<EOF
#     $(databricks.host)
#     $(databricks.token)
#     EOF
#     echo -e "\nDatabricks workspace list:"
#     databricks workspace list

- bash: |
    databricks workspace list --profile AZDO
    databricks workspace import_dir -o --profile AZDO $(Build.SourcesDirectory)/databricks/ /demo
